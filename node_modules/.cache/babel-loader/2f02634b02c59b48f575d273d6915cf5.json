{"remainingRequest":"/home/paltus/PycharmProjects/Docs_Service_REST_v2/tablegenfront/node_modules/babel-loader/lib/index.js!/home/paltus/PycharmProjects/Docs_Service_REST_v2/tablegenfront/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/paltus/PycharmProjects/Docs_Service_REST_v2/tablegenfront/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/paltus/PycharmProjects/Docs_Service_REST_v2/tablegenfront/src/components/LoginForm.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/paltus/PycharmProjects/Docs_Service_REST_v2/tablegenfront/src/components/LoginForm.vue","mtime":1588636596830},{"path":"/home/paltus/PycharmProjects/Docs_Service_REST_v2/tablegenfront/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/paltus/PycharmProjects/Docs_Service_REST_v2/tablegenfront/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/paltus/PycharmProjects/Docs_Service_REST_v2/tablegenfront/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/paltus/PycharmProjects/Docs_Service_REST_v2/tablegenfront/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiL2hvbWUvcGFsdHVzL1B5Y2hhcm1Qcm9qZWN0cy9Eb2NzX1NlcnZpY2VfUkVTVF92Mi90YWJsZWdlbmZyb250L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKaW1wb3J0IHJvdXRlciBmcm9tICIuLi9yb3V0ZXIvaW5kZXgiOwppbXBvcnQgc3RvcmUgZnJvbSAiLi4vc3RvcmUiOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHVzZXJuYW1lOiAnJywKICAgICAgdXNlcm5hbWVfc3RhdGU6IG51bGwsCiAgICAgIHBhc3N3b3JkOiAnJywKICAgICAgcGFzc3dvcmRfc3RhdGU6IG51bGwsCiAgICAgIHRva2VuOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlci10b2tlbicpIHx8IG51bGwsCiAgICAgIGVycm9yOiBmYWxzZQogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGxvZ2luOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfbG9naW4gPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgICAgdmFyIHVzZXJuYW1lLCBwYXNzd29yZDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICB0aGlzLmVycm9yID0gZmFsc2U7CiAgICAgICAgICAgICAgICB0aGlzLnVzZXJuYW1lX3N0YXRlID0gbnVsbDsKICAgICAgICAgICAgICAgIHRoaXMucGFzc3dvcmRfc3RhdGUgPSBudWxsOwogICAgICAgICAgICAgICAgaWYgKHRoaXMudXNlcm5hbWUgPT09ICcnKSB0aGlzLnVzZXJuYW1lX3N0YXRlID0gZmFsc2U7ZWxzZSB0aGlzLnVzZXJuYW1lX3N0YXRlID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhc3N3b3JkID09PSAnJykgdGhpcy5wYXNzd29yZF9zdGF0ZSA9IGZhbHNlO2Vsc2UgdGhpcy5wYXNzd29yZF9zdGF0ZSA9IG51bGw7CgogICAgICAgICAgICAgICAgaWYgKCEodGhpcy51c2VybmFtZV9zdGF0ZSA9PT0gZmFsc2UgfHwgdGhpcy5wYXNzd29yZF9zdGF0ZSA9PT0gZmFsc2UpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgdXNlcm5hbWUgPSB0aGlzLnVzZXJuYW1lOwogICAgICAgICAgICAgICAgcGFzc3dvcmQgPSB0aGlzLnBhc3N3b3JkOwogICAgICAgICAgICAgICAgYXhpb3MoewogICAgICAgICAgICAgICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjYwNjAvYXV0aC8nLAogICAgICAgICAgICAgICAgICBkYXRhOiB7CiAgICAgICAgICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLAogICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZAogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJwogICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcCkgewogICAgICAgICAgICAgICAgICBpZiAocmVzcC5kYXRhLnJlc3VsdCA9PT0gJ29rJykgewogICAgICAgICAgICAgICAgICAgIHZhciB1c2VyX2luZm8gPSB7CiAgICAgICAgICAgICAgICAgICAgICAndG9rZW4nOiByZXNwLmRhdGEucGFyYW1zLnRva2VuLAogICAgICAgICAgICAgICAgICAgICAgJ3VzZXInOiByZXNwLmRhdGEucGFyYW1zLnVzZXIKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd1c2VyLXRva2VuJywgdXNlcl9pbmZvWyd0b2tlbiddKTsKICAgICAgICAgICAgICAgICAgICBheGlvcy5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnQXV0aG9yaXphdGlvbiddID0gJ1Rva2VuICcgKyByZXNwLmRhdGEucGFyYW1zLnRva2VuOwogICAgICAgICAgICAgICAgICAgIHN0b3JlLmNvbW1pdCgnYXV0aF9zdWNjZXNzJywgdXNlcl9pbmZvKTsKICAgICAgICAgICAgICAgICAgICByb3V0ZXIucHVzaCgnLycpOyAvLyByZXNvbHZlKHJlc3ApCiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgc3RvcmUuY29tbWl0KCdhdXRoX2Vycm9yJywgcmVzcC5kYXRhLnJlc3VsdCk7CiAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3VzZXItdG9rZW4nKTsKICAgICAgICAgICAgICAgICAgICBfdGhpcy5lcnJvciA9IHRydWU7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGxvZ2luKCkgewogICAgICAgIHJldHVybiBfbG9naW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGxvZ2luOwogICAgfSgpCiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyLXRva2VuJykgIT09IG51bGwpIHsKICAgICAgcm91dGVyLnB1c2goewogICAgICAgIG5hbWU6ICdob21lJwogICAgICB9KTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["LoginForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAuBA,OAAA,KAAA,MAAA,OAAA;AACA,OAAA,MAAA,MAAA,iBAAA;AACA,OAAA,KAAA,MAAA,UAAA;AAEA,eAAA;AACA,EAAA,IAAA,EAAA,gBAAA;AACA,WAAA;AACA,MAAA,QAAA,EAAA,EADA;AAEA,MAAA,cAAA,EAAA,IAFA;AAGA,MAAA,QAAA,EAAA,EAHA;AAIA,MAAA,cAAA,EAAA,IAJA;AAKA,MAAA,KAAA,EAAA,YAAA,CAAA,OAAA,CAAA,YAAA,KAAA,IALA;AAMA,MAAA,KAAA,EAAA;AANA,KAAA;AAQA,GAVA;AAWA,EAAA,OAAA,EAAA;AACA,IAAA,KAAA;AAAA,2EAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,qBAAA,KAAA,GAAA,KAAA;AACA,qBAAA,cAAA,GAAA,IAAA;AACA,qBAAA,cAAA,GAAA,IAAA;AACA,oBAAA,KAAA,QAAA,KAAA,EAAA,EAAA,KAAA,cAAA,GAAA,KAAA,CAAA,KACA,KAAA,cAAA,GAAA,IAAA;AACA,oBAAA,KAAA,QAAA,KAAA,EAAA,EAAA,KAAA,cAAA,GAAA,KAAA,CAAA,KACA,KAAA,cAAA,GAAA,IAAA;;AAPA,sBAQA,KAAA,cAAA,KAAA,KAAA,IAAA,KAAA,cAAA,KAAA,KARA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAUA,gBAAA,QAVA,GAUA,KAAA,QAVA;AAWA,gBAAA,QAXA,GAWA,KAAA,QAXA;AAYA,gBAAA,KAAA,CAAA;AAAA,kBAAA,GAAA,EAAA,6BAAA;AAAA,kBAAA,IAAA,EAAA;AAAA,oBAAA,QAAA,EAAA,QAAA;AAAA,oBAAA,QAAA,EAAA;AAAA,mBAAA;AAAA,kBAAA,MAAA,EAAA;AAAA,iBAAA,CAAA,CACA,IADA,CACA,UAAA,IAAA,EAAA;AACA,sBAAA,IAAA,CAAA,IAAA,CAAA,MAAA,KAAA,IAAA,EAAA;AACA,wBAAA,SAAA,GAAA;AAAA,+BAAA,IAAA,CAAA,IAAA,CAAA,MAAA,CAAA,KAAA;AAAA,8BAAA,IAAA,CAAA,IAAA,CAAA,MAAA,CAAA;AAAA,qBAAA;AACA,oBAAA,YAAA,CAAA,OAAA,CAAA,YAAA,EAAA,SAAA,CAAA,OAAA,CAAA;AACA,oBAAA,KAAA,CAAA,QAAA,CAAA,OAAA,CAAA,MAAA,CAAA,eAAA,IAAA,WAAA,IAAA,CAAA,IAAA,CAAA,MAAA,CAAA,KAAA;AACA,oBAAA,KAAA,CAAA,MAAA,CAAA,cAAA,EAAA,SAAA;AACA,oBAAA,MAAA,CAAA,IAAA,CAAA,GAAA,EALA,CAMA;AACA,mBAPA,MAQA;AACA,oBAAA,KAAA,CAAA,MAAA,CAAA,YAAA,EAAA,IAAA,CAAA,IAAA,CAAA,MAAA;AACA,oBAAA,YAAA,CAAA,UAAA,CAAA,YAAA;AACA,oBAAA,KAAA,CAAA,KAAA,GAAA,IAAA;AACA;AACA,iBAfA;;AAZA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AADA,GAXA;AA0CA,EAAA,OA1CA,qBA0CA;AACA,QAAA,YAAA,CAAA,OAAA,CAAA,YAAA,MAAA,IAAA,EAAA;AACA,MAAA,MAAA,CAAA,IAAA,CAAA;AAAA,QAAA,IAAA,EAAA;AAAA,OAAA;AACA;AACA;AA9CA,CAAA","sourcesContent":["<template>\n  <div>\n    <b-card class=\"login-card\">\n      <b-card-title>\n        <header class=\"\">\n          <p>Вход</p>\n        </header>\n        <b-card-sub-title v-if=\"error\" class=\"error-subtitle\">Ошибка. Проверьте введенные данные.</b-card-sub-title>\n      </b-card-title>\n      <b-card-body>\n        <b-form-input type=\"text\" name=\"username\" v-model=\"username\" :state=\"username_state\" @change=\"username_state = null\" placeholder=\"№ Билета / Email\" required></b-form-input>\n        <b-form-input  type=\"password\" name=\"password\" v-model=\"password\" :state=\"password_state\" @change=\"password_state = null\" placeholder=\"Пароль\" required class=\"mt-3\"/>\n      </b-card-body>\n      <b-card-footer>\n        <b-button squared class=\"button is-primary\" @click='login'>Войти</b-button>\n        <br/>\n        <b-link class=\"button is-primary\" @click=\"$router.push({name: 'registrationForm'})\">Регистрация</b-link>\n      </b-card-footer>\n    </b-card>\n  </div>\n</template>\n\n<script>\n    import axios from 'axios'\n    import router from \"../router/index\";\n    import store from \"../store\";\n\n    export default {\n      data: function () {\n        return {\n          username: '',\n          username_state: null,\n          password: '',\n          password_state: null,\n          token: localStorage.getItem('user-token') || null,\n          error: false\n        }\n      },\n      methods: {\n        login: async function () {\n          this.error = false\n          this.username_state = null\n          this.password_state = null\n          if (this.username === '') this.username_state = false\n          else this.username_state = null\n          if (this.password === '') this.password_state = false\n          else this.password_state = null\n          if (this.username_state === false || this.password_state === false) return\n\n          let username = this.username\n          let password = this.password\n          axios({url: 'http://localhost:6060/auth/', data: {username, password}, method: 'POST'})\n            .then(resp => {\n              if (resp.data.result === 'ok') {\n                let user_info = {'token': resp.data.params.token, 'user': resp.data.params.user }\n                localStorage.setItem('user-token', user_info['token'])\n                axios.defaults.headers.common['Authorization'] = 'Token ' + resp.data.params.token\n                store.commit('auth_success', user_info)\n                router.push('/')\n                // resolve(resp)\n              }\n              else {\n               store.commit('auth_error', resp.data.result)\n               localStorage.removeItem('user-token')\n                this.error = true\n              }\n            })\n        },\n      },\n      created() {\n        if (localStorage.getItem('user-token') !== null) {\n          router.push({name: 'home'})\n        }\n      }\n    }\n</script>\n\n\n\n<style scoped>\n  .login-card {\n    width: 400px;\n    max-height: 300px;\n    position: absolute;\n    top: calc(50% - 150px);\n    left: calc(50% - 200px);\n  }\n .login-card .error-subtitle {\n    position: absolute;\n    left: 0;\n    right: 0;\n    margin-left: auto;\n    margin-right: auto;\n    width: 300px; /* Need a specific value to work */\n }\n</style>"],"sourceRoot":"src/components"}]}